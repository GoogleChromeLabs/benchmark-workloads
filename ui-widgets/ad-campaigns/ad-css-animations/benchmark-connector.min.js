window.name = "ad-css-animations"; window.version = "1.0.0"; function triggerEvent(t,e,a){const s=new CustomEvent(e);s.name=e,s.state=a,t.dispatchEvent(s)}const pushState=history.pushState;history.pushState=function(t){const e=pushState.apply(history,arguments);return triggerEvent(window,"pushstate",t),triggerEvent(window,"statechange",t),e};const replaceState=history.replaceState;history.replaceState=function(t){const e=replaceState.apply(history,arguments);return triggerEvent(window,"replacestate",t),triggerEvent(window,"statechange",t),e},window.addEventListener("popstate",(function(t){triggerEvent(window,"statechange",t.state)}));const appId=window.name&&window.version?`${window.name}-${window.version}`:-1;function sendMessage(t){window.requestAnimationFrame((()=>{setTimeout((()=>{setTimeout((()=>{window.top.postMessage(t,"*")}),0)}),0)}))}window.onmessage=async t=>{if(t.data.id===appId&&"benchmark-connector"===t.data.key)switch(t.data.type){case"benchmark-test-step":window.benchmarkTestManager.getSuiteByName(t.data.test).getTestByName(t.data.step).run(),sendMessage({type:"test-complete",status:"success",appId:appId});break;case"benchmark-test-function":const e=new Function(`return ${t.data.fn}`)();e&&(requestAnimationFrame((()=>{performance.mark(`${t.data.step}-start`)})),requestAnimationFrame((async()=>{await e(),setTimeout((()=>{performance.mark(`${t.data.step}-end`),performance.measure(`${t.data.step}`,{start:`${t.data.step}-start`,end:`${t.data.step}-end`});const e=JSON.stringify(performance.getEntriesByName(`${t.data.step}`)[0]);window.top.postMessage({type:"test-complete",status:"success",appId:appId,result:e},"*")}),0)})))}},sendMessage({type:"app-ready",status:"success",appId:appId}),console.log(`Hello, benchmark connector for ${appId} is ready!`);